# 概念设计阶段的困难与取舍

1. 递归关系的角色表达：
   - 多种实现方式（自连接 vs 连接实体）。为避免多角色混淆与便于扩展权限元数据，选择 `UserDelegation` 连接实体并以两条外键边分别命名 `guardian`/`dependent`。
2. Primary Care 唯一：
   - 既要支持多提供者关联，又要强约束唯一主治。采用部分唯一约束（同一用户 `isPrimaryCare=TRUE` 至多一条）并在应用层二次校验。
3. 邀请的 15 天有效期：
   - 概念层表示为派生属性；实现层需定时任务或生成列/触发器，兼顾一致性与性能。
4. 月度汇总派生：
   - `stepsTotal` 来源于原始指标聚合；为保证查询性能与数据新鲜度，需要在物化视图与实时聚合之间权衡。
5. 属性建模粒度：
   - `name` 复合 vs 简化为单字段；保持概念层复合，便于国际化与检索。
6. 取消原因与状态枚举：
   - 自由文本灵活但不利统计；枚举利于一致性但需维护。采用“枚举 + 可选文本”折中。
7. 邀请目标（邮箱/电话）可悬置：
   - 为支持未注册用户邀请，允许脱钩；带来参照完整性与清理的复杂度，需要治理策略（归档/清理任务）。
